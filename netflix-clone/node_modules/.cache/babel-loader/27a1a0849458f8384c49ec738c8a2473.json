{"ast":null,"code":"'use strict';\n/**\n * `rawlist` type prompt\n */\n\nconst _ = {\n  uniq: require('lodash/uniq'),\n  isString: require('lodash/isString'),\n  isNumber: require('lodash/isNumber'),\n  findIndex: require('lodash/findIndex')\n};\n\nconst chalk = require('chalk');\n\nconst {\n  map,\n  takeUntil\n} = require('rxjs/operators');\n\nconst Base = require('./base');\n\nconst Separator = require('../objects/separator');\n\nconst observe = require('../utils/events');\n\nconst Paginator = require('../utils/paginator');\n\nclass ExpandPrompt extends Base {\n  constructor(questions, rl, answers) {\n    super(questions, rl, answers);\n\n    if (!this.opt.choices) {\n      this.throwParamError('choices');\n    }\n\n    this.validateChoices(this.opt.choices); // Add the default `help` (/expand) option\n\n    this.opt.choices.push({\n      key: 'h',\n      name: 'Help, list all options',\n      value: 'help'\n    });\n\n    this.opt.validate = choice => {\n      if (choice == null) {\n        return 'Please enter a valid command';\n      }\n\n      return choice !== 'help';\n    }; // Setup the default string (capitalize the default key)\n\n\n    this.opt.default = this.generateChoicesString(this.opt.choices, this.opt.default);\n    this.paginator = new Paginator(this.screen);\n  }\n  /**\n   * Start the Inquiry session\n   * @param  {Function} cb      Callback when prompt is done\n   * @return {this}\n   */\n\n\n  _run(cb) {\n    this.done = cb; // Save user answer and update prompt to show selected option.\n\n    const events = observe(this.rl);\n    const validation = this.handleSubmitEvents(events.line.pipe(map(this.getCurrentValue.bind(this))));\n    validation.success.forEach(this.onSubmit.bind(this));\n    validation.error.forEach(this.onError.bind(this));\n    this.keypressObs = events.keypress.pipe(takeUntil(validation.success)).forEach(this.onKeypress.bind(this)); // Init the prompt\n\n    this.render();\n    return this;\n  }\n  /**\n   * Render the prompt to screen\n   * @return {ExpandPrompt} self\n   */\n\n\n  render(error, hint) {\n    let message = this.getQuestion();\n    let bottomContent = '';\n\n    if (this.status === 'answered') {\n      message += chalk.cyan(this.answer);\n    } else if (this.status === 'expanded') {\n      const choicesStr = renderChoices(this.opt.choices, this.selectedKey);\n      message += this.paginator.paginate(choicesStr, this.selectedKey, this.opt.pageSize);\n      message += '\\n  Answer: ';\n    }\n\n    message += this.rl.line;\n\n    if (error) {\n      bottomContent = chalk.red('>> ') + error;\n    }\n\n    if (hint) {\n      bottomContent = chalk.cyan('>> ') + hint;\n    }\n\n    this.screen.render(message, bottomContent);\n  }\n\n  getCurrentValue(input) {\n    if (!input) {\n      input = this.rawDefault;\n    }\n\n    const selected = this.opt.choices.where({\n      key: input.toLowerCase().trim()\n    })[0];\n\n    if (!selected) {\n      return null;\n    }\n\n    return selected.value;\n  }\n  /**\n   * Generate the prompt choices string\n   * @return {String}  Choices string\n   */\n\n\n  getChoices() {\n    let output = '';\n    this.opt.choices.forEach(choice => {\n      output += '\\n  ';\n\n      if (choice.type === 'separator') {\n        output += ' ' + choice;\n        return;\n      }\n\n      let choiceStr = choice.key + ') ' + choice.name;\n\n      if (this.selectedKey === choice.key) {\n        choiceStr = chalk.cyan(choiceStr);\n      }\n\n      output += choiceStr;\n    });\n    return output;\n  }\n\n  onError(state) {\n    if (state.value === 'help') {\n      this.selectedKey = '';\n      this.status = 'expanded';\n      this.render();\n      return;\n    }\n\n    this.render(state.isValid);\n  }\n  /**\n   * When user press `enter` key\n   */\n\n\n  onSubmit(state) {\n    this.status = 'answered';\n    const choice = this.opt.choices.where({\n      value: state.value\n    })[0];\n    this.answer = choice.short || choice.name; // Re-render prompt\n\n    this.render();\n    this.screen.done();\n    this.done(state.value);\n  }\n  /**\n   * When user press a key\n   */\n\n\n  onKeypress() {\n    this.selectedKey = this.rl.line.toLowerCase();\n    const selected = this.opt.choices.where({\n      key: this.selectedKey\n    })[0];\n\n    if (this.status === 'expanded') {\n      this.render();\n    } else {\n      this.render(null, selected ? selected.name : null);\n    }\n  }\n  /**\n   * Validate the choices\n   * @param {Array} choices\n   */\n\n\n  validateChoices(choices) {\n    let formatError;\n    const errors = [];\n    const keymap = {};\n    choices.filter(Separator.exclude).forEach(choice => {\n      if (!choice.key || choice.key.length !== 1) {\n        formatError = true;\n      }\n\n      choice.key = String(choice.key).toLowerCase();\n\n      if (keymap[choice.key]) {\n        errors.push(choice.key);\n      }\n\n      keymap[choice.key] = true;\n    });\n\n    if (formatError) {\n      throw new Error('Format error: `key` param must be a single letter and is required.');\n    }\n\n    if (keymap.h) {\n      throw new Error('Reserved key error: `key` param cannot be `h` - this value is reserved.');\n    }\n\n    if (errors.length) {\n      throw new Error('Duplicate key error: `key` param must be unique. Duplicates: ' + _.uniq(errors).join(', '));\n    }\n  }\n  /**\n   * Generate a string out of the choices keys\n   * @param  {Array}  choices\n   * @param  {Number|String} default - the choice index or name to capitalize\n   * @return {String} The rendered choices key string\n   */\n\n\n  generateChoicesString(choices, defaultChoice) {\n    let defIndex = choices.realLength - 1;\n\n    if (_.isNumber(defaultChoice) && this.opt.choices.getChoice(defaultChoice)) {\n      defIndex = defaultChoice;\n    } else if (_.isString(defaultChoice)) {\n      const index = _.findIndex(choices.realChoices, _ref => {\n        let {\n          value\n        } = _ref;\n        return value === defaultChoice;\n      });\n\n      defIndex = index === -1 ? defIndex : index;\n    }\n\n    const defStr = this.opt.choices.pluck('key');\n    this.rawDefault = defStr[defIndex];\n    defStr[defIndex] = String(defStr[defIndex]).toUpperCase();\n    return defStr.join('');\n  }\n\n}\n/**\n * Function for rendering checkbox choices\n * @param  {String} pointer Selected key\n * @return {String}         Rendered content\n */\n\n\nfunction renderChoices(choices, pointer) {\n  let output = '';\n  choices.forEach(choice => {\n    output += '\\n  ';\n\n    if (choice.type === 'separator') {\n      output += ' ' + choice;\n      return;\n    }\n\n    let choiceStr = choice.key + ') ' + choice.name;\n\n    if (pointer === choice.key) {\n      choiceStr = chalk.cyan(choiceStr);\n    }\n\n    output += choiceStr;\n  });\n  return output;\n}\n\nmodule.exports = ExpandPrompt;","map":{"version":3,"sources":["C:/Users/DELL/OneDrive/Desktop/React/netflix-clone/node_modules/firebase-tools/node_modules/inquirer/lib/prompts/expand.js"],"names":["_","uniq","require","isString","isNumber","findIndex","chalk","map","takeUntil","Base","Separator","observe","Paginator","ExpandPrompt","constructor","questions","rl","answers","opt","choices","throwParamError","validateChoices","push","key","name","value","validate","choice","default","generateChoicesString","paginator","screen","_run","cb","done","events","validation","handleSubmitEvents","line","pipe","getCurrentValue","bind","success","forEach","onSubmit","error","onError","keypressObs","keypress","onKeypress","render","hint","message","getQuestion","bottomContent","status","cyan","answer","choicesStr","renderChoices","selectedKey","paginate","pageSize","red","input","rawDefault","selected","where","toLowerCase","trim","getChoices","output","type","choiceStr","state","isValid","short","formatError","errors","keymap","filter","exclude","length","String","Error","h","join","defaultChoice","defIndex","realLength","getChoice","index","realChoices","defStr","pluck","toUpperCase","pointer","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n/**\n * `rawlist` type prompt\n */\n\nconst _ = {\n  uniq: require('lodash/uniq'),\n  isString: require('lodash/isString'),\n  isNumber: require('lodash/isNumber'),\n  findIndex: require('lodash/findIndex'),\n};\nconst chalk = require('chalk');\nconst { map, takeUntil } = require('rxjs/operators');\nconst Base = require('./base');\nconst Separator = require('../objects/separator');\nconst observe = require('../utils/events');\nconst Paginator = require('../utils/paginator');\n\nclass ExpandPrompt extends Base {\n  constructor(questions, rl, answers) {\n    super(questions, rl, answers);\n\n    if (!this.opt.choices) {\n      this.throwParamError('choices');\n    }\n\n    this.validateChoices(this.opt.choices);\n\n    // Add the default `help` (/expand) option\n    this.opt.choices.push({\n      key: 'h',\n      name: 'Help, list all options',\n      value: 'help',\n    });\n\n    this.opt.validate = (choice) => {\n      if (choice == null) {\n        return 'Please enter a valid command';\n      }\n\n      return choice !== 'help';\n    };\n\n    // Setup the default string (capitalize the default key)\n    this.opt.default = this.generateChoicesString(this.opt.choices, this.opt.default);\n\n    this.paginator = new Paginator(this.screen);\n  }\n\n  /**\n   * Start the Inquiry session\n   * @param  {Function} cb      Callback when prompt is done\n   * @return {this}\n   */\n\n  _run(cb) {\n    this.done = cb;\n\n    // Save user answer and update prompt to show selected option.\n    const events = observe(this.rl);\n    const validation = this.handleSubmitEvents(\n      events.line.pipe(map(this.getCurrentValue.bind(this)))\n    );\n    validation.success.forEach(this.onSubmit.bind(this));\n    validation.error.forEach(this.onError.bind(this));\n    this.keypressObs = events.keypress\n      .pipe(takeUntil(validation.success))\n      .forEach(this.onKeypress.bind(this));\n\n    // Init the prompt\n    this.render();\n\n    return this;\n  }\n\n  /**\n   * Render the prompt to screen\n   * @return {ExpandPrompt} self\n   */\n\n  render(error, hint) {\n    let message = this.getQuestion();\n    let bottomContent = '';\n\n    if (this.status === 'answered') {\n      message += chalk.cyan(this.answer);\n    } else if (this.status === 'expanded') {\n      const choicesStr = renderChoices(this.opt.choices, this.selectedKey);\n      message += this.paginator.paginate(choicesStr, this.selectedKey, this.opt.pageSize);\n      message += '\\n  Answer: ';\n    }\n\n    message += this.rl.line;\n\n    if (error) {\n      bottomContent = chalk.red('>> ') + error;\n    }\n\n    if (hint) {\n      bottomContent = chalk.cyan('>> ') + hint;\n    }\n\n    this.screen.render(message, bottomContent);\n  }\n\n  getCurrentValue(input) {\n    if (!input) {\n      input = this.rawDefault;\n    }\n\n    const selected = this.opt.choices.where({ key: input.toLowerCase().trim() })[0];\n    if (!selected) {\n      return null;\n    }\n\n    return selected.value;\n  }\n\n  /**\n   * Generate the prompt choices string\n   * @return {String}  Choices string\n   */\n\n  getChoices() {\n    let output = '';\n\n    this.opt.choices.forEach((choice) => {\n      output += '\\n  ';\n\n      if (choice.type === 'separator') {\n        output += ' ' + choice;\n        return;\n      }\n\n      let choiceStr = choice.key + ') ' + choice.name;\n      if (this.selectedKey === choice.key) {\n        choiceStr = chalk.cyan(choiceStr);\n      }\n\n      output += choiceStr;\n    });\n\n    return output;\n  }\n\n  onError(state) {\n    if (state.value === 'help') {\n      this.selectedKey = '';\n      this.status = 'expanded';\n      this.render();\n      return;\n    }\n\n    this.render(state.isValid);\n  }\n\n  /**\n   * When user press `enter` key\n   */\n\n  onSubmit(state) {\n    this.status = 'answered';\n    const choice = this.opt.choices.where({ value: state.value })[0];\n    this.answer = choice.short || choice.name;\n\n    // Re-render prompt\n    this.render();\n    this.screen.done();\n    this.done(state.value);\n  }\n\n  /**\n   * When user press a key\n   */\n\n  onKeypress() {\n    this.selectedKey = this.rl.line.toLowerCase();\n    const selected = this.opt.choices.where({ key: this.selectedKey })[0];\n    if (this.status === 'expanded') {\n      this.render();\n    } else {\n      this.render(null, selected ? selected.name : null);\n    }\n  }\n\n  /**\n   * Validate the choices\n   * @param {Array} choices\n   */\n\n  validateChoices(choices) {\n    let formatError;\n    const errors = [];\n    const keymap = {};\n    choices.filter(Separator.exclude).forEach((choice) => {\n      if (!choice.key || choice.key.length !== 1) {\n        formatError = true;\n      }\n\n      choice.key = String(choice.key).toLowerCase();\n\n      if (keymap[choice.key]) {\n        errors.push(choice.key);\n      }\n\n      keymap[choice.key] = true;\n    });\n\n    if (formatError) {\n      throw new Error(\n        'Format error: `key` param must be a single letter and is required.'\n      );\n    }\n\n    if (keymap.h) {\n      throw new Error(\n        'Reserved key error: `key` param cannot be `h` - this value is reserved.'\n      );\n    }\n\n    if (errors.length) {\n      throw new Error(\n        'Duplicate key error: `key` param must be unique. Duplicates: ' +\n          _.uniq(errors).join(', ')\n      );\n    }\n  }\n\n  /**\n   * Generate a string out of the choices keys\n   * @param  {Array}  choices\n   * @param  {Number|String} default - the choice index or name to capitalize\n   * @return {String} The rendered choices key string\n   */\n  generateChoicesString(choices, defaultChoice) {\n    let defIndex = choices.realLength - 1;\n    if (_.isNumber(defaultChoice) && this.opt.choices.getChoice(defaultChoice)) {\n      defIndex = defaultChoice;\n    } else if (_.isString(defaultChoice)) {\n      const index = _.findIndex(\n        choices.realChoices,\n        ({ value }) => value === defaultChoice\n      );\n      defIndex = index === -1 ? defIndex : index;\n    }\n\n    const defStr = this.opt.choices.pluck('key');\n    this.rawDefault = defStr[defIndex];\n    defStr[defIndex] = String(defStr[defIndex]).toUpperCase();\n    return defStr.join('');\n  }\n}\n\n/**\n * Function for rendering checkbox choices\n * @param  {String} pointer Selected key\n * @return {String}         Rendered content\n */\n\nfunction renderChoices(choices, pointer) {\n  let output = '';\n\n  choices.forEach((choice) => {\n    output += '\\n  ';\n\n    if (choice.type === 'separator') {\n      output += ' ' + choice;\n      return;\n    }\n\n    let choiceStr = choice.key + ') ' + choice.name;\n    if (pointer === choice.key) {\n      choiceStr = chalk.cyan(choiceStr);\n    }\n\n    output += choiceStr;\n  });\n\n  return output;\n}\n\nmodule.exports = ExpandPrompt;\n"]},"metadata":{},"sourceType":"script"}